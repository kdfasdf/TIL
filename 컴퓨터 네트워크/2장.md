워밍업
1. 패킷을 받는 수신자의 IP 주소는 TCP 헤더와 IP 헤더 중 어느쪽에 포함되어 있을까?
2. 서버 프로그램의 종류를 지정하기 위해 사용하는 포트번호는 TCP 헤더와 IP 헤더 중 어느쪽에 포함되어 있을까?
3. 패킷이 올바르게 도착했는지 여부를 확인하는 것은 TCP 와 IP 중 어느쪽일까?
4. 이더넷의 MAC 주소는 몇 비트로 이루어져 있을까?
5. 트위스티드 페어 케이블 길이에는 제한이 있는ㅈ데, 몇 미터까지 제한할까?
<br>
<br>

- 2 장에는 거의 모든 section에 그림이 있으니 책을 참고할 것

1.IP 헤더
- IP 헤더에는 패킷을 목적지로 전송할 때 필요한 제어정보를 담고있는데 수신자 주소는 그 중에서 가장 중요한 정보이다
2. TCP 헤더
- TCP 헤더에는 통신 상대와 데이터를 올바르게 주고받기 위해 필요한 제어정보가 담겨있는데, 포트번호는 통신 상대의 프로그램을 지정하는 중요한 정보이다. 
3. TCP 
- TCP는 패킷이 올바르게 도착했는지 확인하고, 도착하지 않았을 때는 패킷을 다시 보낸다
4. 48비트
- MAC 주소는 48비트이며, 전세계적으로 중복되지 않도록 일관적으로 관리하고 있다
5. 100미터
- 이더넷의 표준은 트위스티드 페어를 사용했을 경우, 100미터까지의 거리를 보장하고 있다. 그러므로 그 이상의 거리에서는 정상적으로 통신할 수 없게 될 가능성이 커진다.
<br>
<br>

serction 1 TCP-IP 소프트웨어의 내부 구성
1장에서 주소란에 입력된 URL을 해석하고 이를 바탕으로 HTTP 리퀘스트 메시지를 만ㄷ르어 TCP/IP 소프트웨어에 송신을 요청하는 과정을 알아봤다
<br>

이번 장에서는 메시지를 웹 서버를 향해 내보내는 부분을 알아본다

<br>

우선 TCP/IP의 메시지를 패킷의 형태로 바꾸는 것을 이해하려면 TCP/IP 의 구조에 대해서 알아야 한다. (책 그림 참고)
- 가장 위(네트워크 애플리케이션)
  - 웹서버, 메일 서버와 같은 프로그램이 이에 해당
  - 여기서 부터 아래를 향해 데이터 송수신을 요청
- OS
  - 네트워크 애플리케이션 아래 계층 TCP/IP, UDP 층과 IP층이 있음
  - TCP/IP 소프트웨어가 위치
  - TCP/IP 에는 TCP라는 프로토콜을 써서 데이터 송수인을 제어하는 부분과,
  - UDP라는 프로토콜을 사용해서 데이터 송수신을 제어하는 부분이 있음
  - 웹, 메일 등 일반적인 애플리케이션 -TCP
  - DNS 서버로의 질의 짧은 제어용 데이터를 송수신하는 경우 UDP
  - TCP/IP , UDP 아래에는 IP 프로토콜을 사용해서 패킷 송수신 동작을 제어하는 부분이 있음
  - 인터넷에서 데이터를 전송할 때 데이터를 잘게 나눈 패킷이라는 형태로 전송하는데 그 패킷의 송수신을 제어하는 것이 IP의 주된 역할
  - IP에는 ICMP와 ARP 가 포함되어 있음
  - ICMP는 패킷을 전송했을 때 오류가 생겼을 경우 통지하는 역할을 하고
  - ARP 는 이더넷의 MAC 주소를 조회할 때 사용

- IP 아래에 있는 LAN 드라이버는 LAN 카드의 하드웨어를 제어하는 것이고, 그 아래에 있는 LAN 카드가 실제의 송수신동작, 즉 케이블에 신호를 송수신하게 된다.


- 메시지를 전송하는 첫 단계
  - TCP/IP 소프트웨어로 메시지를 패킷의 형태로 바꾼다.

section 2 - 소켓의 실체는 TCP/IP 소프트웨어 내부의 메모리
- 소켓의 실체는 TCP/IP 소프트웨어 내부에서 관리하는 메모리 영역임 TCP를 쓰느냐 UDP를 쓰느냐, 통신 동작이 어떤 진행상태에 있는가 등을 나타내는 제어 정보가 저장되어 있음 TCP/IP 소프트웨어 내부에 있는 TCP,UDP,IP와 같은 프로그램은 이것을 참조하면서 동작
- 또한 통신상태에 대한 정보를 저장해두는데 통신을 하고 있는지, 하고 있다면 해당 애플리케이션은 몇번 포트를 이용하고 있는지를 저장한다 cmd에서 netstat -ano 를 했을 때 보이는 행 하나하나가 소켓이라고 보면 된다.

section 3 
책에 그림이 있으므로 책을 보는 것이 나음<br>
결과적으로 네트워크에서 송수신할 때 하나의 웹 서버 컴퓨터에서 여러 개의 웹 서버 프로그램을 실행할 때 다른 서버 프로그램들이 같은 포트를 사용하게 되는데 이 때 여러개의 클라이언트의 요청 중에서 어떤 클라이언트가 어떤 서버 프로그램을 이용할지는 클라이언트 쪽의 포트와 IP 주소로 구분할 수 있다<br>
TCP/IP 소프트웨어는 이와 같이 소켓을 조사해서 수신한 데이터를 어느 서버 프로그램에 넘겨야 하는지를 판단하는데 이 떄문에 수신측의 IP 줏와 포트번호, 송신측의 IP 주소와 포트 번호 네 가지가 모두 같은 값을 갖는 소켓이 두 개 이상인 경우에는  데이터를 넘기는 서버 프로그램을 판단할 수 없게 된다
<br> 따라서 이 같은 경우에는 통신오류가 발생한다.

section 4 - TCP/IP 소프트웨어는 먼저 소켓을 작성한다
소켓이 생성과 사용
1. DNS 서버에 질의 하는 동작
2. 소켓을 만들 때 OS 에 요청하여 소켓 하나 만큼으 메모리 영역을 확보
3. 확보한 메모리 영역에 제어 정보를 기록(IPv4 사용 ,TCP 사용 등)
4. 소켓 생성이 끝나고 통신준비가 끝나면 socket은 호출한 애플리케이션에게 디스크립터를 반환
5. 디스크립터를 받은 애플리케이션은  이후 TCP/IP 소프트웨어에 데이터 송수신 동작을 요청할 때 통신 상대의 정보 대신 디스크립터를 알려줌

<br> 

소켓의 호출 순서
1. DNS 서버와 IP 주소를 문의하는 메시지를 교환
2. 통신 게시를 알리는 제어용의 패킷을 교환
3. 송신 데이터를 상대에 송신
4. 상대로부터 보내온 데이터를 수신
5. 통신 종료를 알리는 제어용의 패킷을 교환

section 5 - 소켓을 만든 후 TCP로 파이프를 연결한다
- 소켓을 생성한 후 소켓 라이브러리에 있는 connect라는 프로그램을 호출하여 통신시작을 알리는 제어 정보를 주고 받음
- connect에는 통신 상대의 주소와 애플리케이션의 포트 번호가 넘겨지고 클라이언트측 프로그램과 서버측 프로그램의 포트를 논리적으로 연결한다
- 마찬가지로 close를 하면 논리적 연결 해제

section 6 - 접속, 데이터 송숫신, 종료의 3단계로 관리
커넥션에 대한 동작을 제어하면서 데이터를 전송하는 것이 TCP의 역할
- 최초의 접속 단계는 다음과 같이 동작. 먼저 접속하려는 쪽이 접속을 기다리는 쪽에 지금부터 데이터를 보낸다는 전송 제어 정보를 담은 패킷을 보냄
- 접속을 기다리던 서버측은 이에 OK 응답을 하면서 데이터 전송 제어정보를 보냄 (하나의 패킷에 통신 개시와 수신확인의 두 가지 정보를 실어서 되돌려보내는 것
- 접속하는 측이 확인 응답을 함
TCP 데이터 송수신은 전이중 방식으로(두 대의 단말기가 데이터를 송수신하기 위해 동시에 각각 독립된 회선을 사용하는 통신방식) 통신함<br>
따라서 양방향으로 데이터를 주고받을 수 있는데 양방향 데이터 송신 동작이 독립되어 서로 영향을 받지 않고 동작함 그러므로 각각의 방향으로 제어 정보를 따로따로 통지하게 되고 제어정보를 통지하면 반드시 이에대한 확인 응답을 보내야함
제어정보를 주고 받는 과정에서 오류가 발생할 수 있기 떄문에 정상적으로 패킷이 도착했다는 것을 알리기 위해 반드시 수신 확인 응답을 보내는 것
